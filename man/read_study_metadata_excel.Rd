% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/read_study_metadata_excel.R
\name{read_study_metadata_excel}
\alias{read_study_metadata_excel}
\title{Read study metadata from a multi-sheet Excel workbook}
\usage{
read_study_metadata_excel(path)
}
\arguments{
\item{path}{Character. Path to the \code{.xlsx} file.}
}
\value{
Named list with components:
\describe{
\item{study_name}{Character. Study name from the Meta sheet.}
\item{target_meta}{Tibble. Variable-level metadata in standard format
(columns: domain, var, type, label, role, core, codelist_id, order,
length, significant_digits, value_level_id, rule_type, var_model, ...).}
\item{domain_meta}{Tibble. Domain-level metadata with build order
(columns: domain, class, class_order, domain_level_order, keys,
description, structure).}
\item{value_level_meta}{Tibble or NULL. Value-level metadata with
WHERE clause conditions expanded.}
}
}
\description{
Parses \code{Study_Metadata.xlsx} containing sheets:
\itemize{
\item \strong{Meta} — study-level information (study name, select flag)
\item \strong{Standards} — (ignored)
\item \strong{Domains} — domain definitions with build order, keys, labels
\item \strong{Variables} — per-variable definitions with ordering, types, roles
\item \strong{Value Level} — value-level metadata with WHERE clause references
\item \strong{Where Clauses} — condition definitions for value-level metadata
\item \strong{Method} — derivation method descriptions (informational)
}

Each sheet uses a \code{Select} column (\code{"Y"}) to filter active rows.
}
\details{
\subsection{Column Mappings (Variables sheet)}{\tabular{ll}{
   Excel Column \tab Internal Column \cr
   VARNAME \tab var \cr
   VARLABEL \tab label \cr
   DATA_TYPE \tab type (mapped) \cr
   LENGTH \tab length \cr
   SIGNIFICANT_DIGITS \tab significant_digits \cr
   CODELIST_ID \tab codelist_id \cr
   ROLE \tab role \cr
   CORE \tab core \cr
   VLM_ID \tab value_level_id \cr
   METHOD \tab rule_type (mapped) \cr
   VAR_MODEL \tab var_model \cr
}

}

\subsection{Data Type Mappings}{\tabular{ll}{
   Excel DATA_TYPE \tab Internal type \cr
   text \tab char \cr
   integer \tab num \cr
   float \tab num \cr
   datetime \tab char \cr
   durationDatetime \tab char \cr
}

}
}
