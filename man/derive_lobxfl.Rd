% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mod_g6_derive_flags.R
\name{derive_lobxfl}
\alias{derive_lobxfl}
\title{Derive --LOBXFL flag for last pre-exposure observation}
\usage{
derive_lobxfl(domain_data, dm_data, sdtm_domain, add_val_rule = NULL)
}
\arguments{
\item{domain_data}{A tibble containing the SDTM domain data.}

\item{dm_data}{A tibble containing the DM dataset with \code{USUBJID}
and \code{RFXSTDTC}.}

\item{sdtm_domain}{Character. Two-letter SDTM domain code (e.g.,
\code{"LB"}, \code{"VS"}, \code{"QS"}).}

\item{add_val_rule}{Optional quoted expression (e.g., \code{rlang::expr(...)})
adding extra conditions to the default \code{!is.na(--ORRES)} rule.}
}
\value{
A tibble with the derived \code{--LOBXFL} flag.
}
\description{
Flags the last valid observation before the reference exposure start
date (\code{RFXSTDTC}) for each subject and test code, using the SDTM
convention for \code{--LOBXFL}.
}
\details{
Processing steps:
\enumerate{
\item Parse \code{--DTC} and \code{RFXSTDTC} into datetime.
\item Define \emph{valid} = \code{!is.na(--ORRES)} AND (optionally) \code{add_val_rule}.
\item Flag the latest pre-exposure record per \code{USUBJID} / \code{--TESTCD}.
}
}
