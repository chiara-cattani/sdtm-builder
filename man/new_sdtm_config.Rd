% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mod_a_primitives.R
\name{new_sdtm_config}
\alias{new_sdtm_config}
\title{Create a validated SDTM study configuration object}
\usage{
new_sdtm_config(
  studyid,
  timezone = "UTC",
  ref_start_rule,
  visit_map = NULL,
  ct_paths = character(),
  sponsor_overrides = list(),
  imputation_policy = list(),
  log_level = "INFO",
  legacy_quirks = list()
)
}
\arguments{
\item{studyid}{Character (required). The study identifier, e.g. \code{"STUDY001"}.}

\item{timezone}{Character. IANA timezone string, default \code{"UTC"}.}

\item{ref_start_rule}{List (required). How to determine RFSTDTC.
Must contain \code{var} (character) and \code{source} (character), e.g.
\code{list(var = "RFSTDTC", source = "DM")} or a function.}

\item{visit_map}{Data frame or \code{NULL}. Columns: \code{VISIT}, \code{VISITNUM},
\code{VISITDY} (optional), \code{WINDOW_LO}, \code{WINDOW_HI} (optional).}

\item{ct_paths}{Character vector. Paths to controlled terminology files
(CDISC CT packages, sponsor extensions).}

\item{sponsor_overrides}{Named list. Domain or variable-level overrides:
custom labels, lengths, sort keys, derivation exceptions.}

\item{imputation_policy}{List or function. Partial-date imputation rules.
Example: \code{list(default_day = 1L, default_month = 1L, method = "first")}.}

\item{log_level}{Character. One of \code{"DEBUG"}, \code{"INFO"}, \code{"WARN"}, \code{"ERROR"}.
Default \code{"INFO"}.}

\item{legacy_quirks}{Named list. Backward-compat flags, e.g.
\code{list(seq_zero_based = FALSE, blank_as_na = TRUE)}.}
}
\value{
An S3 object of class \code{sdtm_config} (a named list).
}
\description{
Constructs a configuration object that encapsulates all study-level settings
needed by the build pipeline: study identity, timezone, reference start date
rules, visit mapping, controlled terminology paths, sponsor conventions,
imputation policies, and logging preferences.

\strong{Does NOT} load data or metadata—only stores settings.
}
\section{Edge cases}{

\itemize{
\item \code{timezone} must be valid (\code{OlsonNames()}); error if not.
\item \code{ref_start_rule} must be a list with \code{var} + \code{source}, or a function.
\item \code{visit_map} is validated for required columns if provided.
\item Unknown \code{sponsor_overrides} keys emit a warning but are kept.
}
}

\section{Unit tests}{

\itemize{
\item Required \code{studyid} missing → error
\item Invalid timezone → error
\item Default values populated correctly
\item Override precedence: sponsor > default
\item \code{visit_map} with wrong columns → error
\item \code{imputation_policy} as function and as list both work
}
}

